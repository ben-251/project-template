---
title: "Laptop Price Prediction"
author: "by The Code Crunchers: Jamie, Gandom, Adam, Ben"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r load-lib, include = FALSE}
library(tidyverse)
library(tidymodels)
library(knitr)
```


```{r load-data, include=FALSE}
laptop_data <- read_csv("data/laptop_data_cleaned.csv")

laptop_data <- laptop_data%>% 
  mutate(, 
storage_type = case_when(
    HDD == 0 ~ "ssd",
    SSD == 0 ~ "hdd",
    .default = "both"
  ))

laptop_data_untidy <- read.csv("data/laptop_data.csv")
laptop_data_untidy <- laptop_data_untidy%>%
  mutate(Ram = parse_number(Ram))
laptop_data_untidy <- laptop_data_untidy%>%
  mutate(Weight = parse_number(Weight))
laptop_data_untidy <- laptop_data_untidy%>%
  mutate(Second_Price = Price)
laptop_data_filtered <- laptop_data_untidy [-1192, ]
laptop_data_filtered <- laptop_data_filtered[1:1273, ]

first_diff <- which(!(laptop_data$Company == laptop_data_filtered$Company & laptop_data$TypeName == laptop_data_filtered$TypeName & laptop_data$Ram == laptop_data_filtered$Ram ))
second_diff <- all(abs(laptop_data$Weight - laptop_data_filtered$Weight) < .Machine$double.eps^0.5)

laptop_data_merged <- cbind(laptop_data, select(laptop_data_filtered, Second_Price, Inches, ScreenResolution, Cpu, Gpu, Memory)) 

laptop_data_tidy <- laptop_data_merged %>%
  mutate(,
         storage_capacity = HDD + SSD
         )

laptop_data_tidy <- laptop_data_tidy%>%
  filter(,storage_capacity != 0)

full_company_list <- laptop_data_tidy %>% 
  count(Company) %>%
  arrange(n)

laptop_data_tidy <- laptop_data_tidy %>%
  mutate(,
    Company = case_when(
      Company == "Acer" ~ "Acer",
      Company == "Asus" ~ "Asus",
      Company == "Dell" ~ "Dell",
      Company == "HP" ~ "HP",
      Company == "Lenovo" ~ "Lenovo",
      TRUE ~ "Other"
    )    
  )

laptop_data_tidy <-laptop_data_tidy %>%
 mutate(
        log_price = log(round(exp(Price) * 0.0094 , digits =2)),
        Price = round(exp(log_price),digits = 2)
        
         )


laptop_data_final <- laptop_data_tidy

laptop_data_final <- laptop_data_final%>%
  mutate(GHz = as.numeric(str_extract(Cpu, "\\d+(\\.\\d+)?(?=GHz)")))

laptop_data_final<-select(laptop_data_final,-Second_Price,-ScreenResolution,-Gpu,-Memory,-Cpu)


```


## Research Question


“To what extent can the price of a laptop be predicted based on some of its specifications and does the price level vary based upon its company”

We can use this model as a way for people to identify what laptop type and from what company to make their purchase based on a series of specifications they want. Our initial questions to investigate included: 'To what degree does the existence of various specifications influence price' and 'to what degree will companies vary their price for the same laptop type'.



## Data

Our selected data sets contain information on 1,196 laptops with 23 variables. “Laptop_data_final” is a merged dataset of two separate collections, cleaned to limit the laptops to the following specifications which we deemed as relevant in our research:

(done on the google docs, I'll paste it in when we finalise the variables we plan on analysing- g)




## Findings

<h3><center>*An analysis of the price of a laptop based on its features and specifications*</center></h3>

<h4>Introduction:</h4>
This report presents findings from the analysis of two laptop datasets - available on Kaggle - to identify patterns and factors affecting price. The dataset contains the information of 1,196 laptops with 23 specifications, such as Company, RAM, Weight and Storage type. Initially, the objective of this analysis was to create a model to aid people in identifying the laptop type and company they should likely purchase from, based on a series of specifications they would like. The research then progressed into an analysis of how price is influenced by the presence of such specifications and by the end of the exploratory data analysis, we found ourselves researching <u>*(WHAT ARE WE RESEARCHING??)*</u>. The following sections outline our methods, results and evaluation of findings as well as some issues we faced and how they were overcome.

It must first be acknowledged that this analysis is subject to certain limitations and should be interpreted with caution. The scope of the laptop statistics was constrained to the companies of Acer, Asus, Dell, HP, Lenovo and Other; categorised into one of the following categories: 2 in 1 Convertible, Netbook, Workstation, Ultrabook, Notebook and Gaming. Thus, while the analysis provides valuable insights, it is not exhaustive and may not capture all potential variables or nuances relevant to the study. Any assumptions made have been mentioned in the ‘data cleaning and wrangling’ and ‘exploratory data analysis’ sections.


<h4>Data cleaning and wrangling:</h4>
First, the two datasets were merged and any duplicate variables were subsequently removed. From the HDD and SSD variables, we created a variable denoting the total amount of storage in the laptop, and subsequently removed any observations with a storage capacity of 0 as this is not possible; such was one of the assumptions we made. Furthermore, we created a variable that denoted whether a laptop had SSD storage, HDD storage or both called “storage_type”. 

At this point, we surmised it would be best to limit the company variable (describing the company from which the laptop is purchased) to only the companies with over 100 laptops, all other companies were then denoted as “other”, this was done to simplify the model as there was a large number of companies with few entries:

```{r few-companies}
kable(full_company_list)
```

The price variable was given originally as log transformed and in rupees, we converted Price back into pounds and also decided to log transform the price in pounds as the data is right skewed:

```{r right-skew-proof, echo=FALSE}
laptop_data_final %>%
  ggplot(mapping = aes(x=Price)) +
  geom_histogram(bins = 25,fill = "orange",color="navyblue")+
  theme_light()+
  labs(
    title = "Spread of laptop prices before log transformation",
    x = "Price",
    y = "Number of Laptops"
  )
```

```{r right-skew-proof-log, echo=FALSE}
laptop_data_final %>%
  ggplot(mapping = aes(x=log_price)) +
  geom_histogram(bins = 25,fill = "orange",color="navyblue")+
  theme_light()+
  labs(
    title = "Spread of laptop prices after log transformation",
    x = "Natural Log of Price",
    y = "Number of Laptops"
  )
```

Using log price also allowed us to avoid the fan-shaped residual plot:
```{r residual-comparison, echo=FALSE}
set.seed(26)
laptop_split <- initial_split(laptop_data_final)
train_data <- training(laptop_split)
test_data  <- testing(laptop_split)
## non-log
price_10_fit2 <- linear_reg() %>%
  set_engine("lm") %>%
  fit(Price ~ Ram + SSD + TypeName + Os + Cpu_brand+ Gpu_brand  + Company, data=train_data)

price_10_fit2_aug <- augment(price_10_fit2$fit)
ggplot(price_10_fit2_aug, mapping = aes(x = .fitted, y = .resid)) +
  geom_point(alpha = 0.5) +
  geom_hline(yintercept = 0, color = "gray", lty = "dashed") +
  labs(title = "Residual Plot after log transform", x = "Predicted height", y = "Residuals")
```
```{r residual-comparison-log, echo=FALSE}
## log
price_log10_fit2 <- linear_reg() %>%
  set_engine("lm") %>%
  fit(log_price ~ Ram + SSD + TypeName + Os + Cpu_brand+ Gpu_brand  + Company, data=train_data)

price_log10_fit2_aug <- augment(price_log10_fit2$fit)
ggplot(price_log10_fit2_aug, mapping = aes(x = .fitted, y = .resid)) +
  geom_point(alpha = 0.5) +
  geom_hline(yintercept = 0, color = "gray", lty = "dashed") +
  labs(title="Residual Plot with log transform",x = "Predicted height", y = "Residuals")
```

Finally we were also able to extract the clock speed of the processor from the uncleaned dataset and store it as a numeric variable.


<h4>(Exploratory data analysis: </h4>
*(research, understanding, calculating summary stats, narrowing observations of interest, create new variables, visualisations) A brief explanation of what the results mean in the given context of the data*


<h4>Modelling:</h4>
*(answers our question)*


<h4>Conclusion: </h4>
*(what are the advantages/ limitations of the investigation. If we had more time what more would we have done) = evaluation*





## References

Kushwaha, G. P. (2023, June 15). Laptop price prediction cleaned dataset. 2024 November 13, Kaggle. 
https://www.kaggle.com/datasets/gyanprakashkushwaha/laptop-price-prediction-cleaned-dataset 

R, J. D. (2023, November 30). Laptop price prediction dataset. 2024 November 13, Kaggle. 
https://www.kaggle.com/datasets/jacksondivakarr/laptop-price-prediction-dataset 



