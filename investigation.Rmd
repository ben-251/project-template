---
title: "IDS investigation worksheet - PULL BEFORE EDITING GUYS!!!"
author: "by The Code Crunchers: Gigi, Ben, Jamie & Adam"
date: "`r Sys.Date()`"
output: html_document
---

**Note:** You can use this file as you 'working document' where you can try out various investigation ideas and keep notes about your findings. How you use and structure this file is up to you. It is recommended that you keep notes about what you are investigating and what you find as this will make the process of creating your presentation and report easier. Please note that you _do not_ need to submit this file as part of your group project.



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r load-lib, message = FALSE}
library(tidyverse)
library(tidymodels)
```


```{r load-data}
laptop_data <- read_csv("data/laptop_data_cleaned.csv")
```

<h3> Data Cleaning and that </h3> 

```{r creating storage_type column - Jamie}
laptop_data <- laptop_data%>% 
  mutate(, 
storage_type = case_when(
    HDD == 0 ~ "ssd",
    SSD == 0 ~ "hss",
    .default = "both"
  ))

```

```{r adam}
laptop_data_untidy <- read.csv("data/laptop_data.csv")
laptop_data_untidy <- laptop_data_untidy%>%
  mutate(Ram = parse_number(Ram))
laptop_data_untidy <- laptop_data_untidy%>%
  mutate(Weight = parse_number(Weight))
laptop_data_untidy <- laptop_data_untidy%>%
  mutate(Second_Price = Price)
laptop_data_filtered <- laptop_data_untidy [-1192, ]
laptop_data_filtered <- laptop_data_filtered[1:1273, ]

#check
first_diff <- which(!(laptop_data$Company == laptop_data_filtered$Company & laptop_data$TypeName == laptop_data_filtered$TypeName & laptop_data$Ram == laptop_data_filtered$Ram ))
second_diff <- all(abs(laptop_data$Weight - laptop_data_filtered$Weight) < .Machine$double.eps^0.5)

##view(select(laptop_data_filtered, Ram, Weight, Company, TypeName))
##view(select(laptop_data, Ram, Weight, Company, TypeName))
##print(first_diff)
##print(second_diff)

laptop_data_merged <- cbind(laptop_data, select(laptop_data_filtered, Second_Price, Inches, ScreenResolution, Cpu, Gpu, Memory)) 

```

```{r creating storage_capacity column - Jamie}

laptop_data_tidy <- laptop_data_merged %>%
  mutate(,
         storage_capacity = HDD + SSD
         )
```

```{r filtering out laptops with 0 storage - Jamie}

laptop_data_tidy <- laptop_data_tidy%>%
  filter(,storage_capacity != 0)
#From the work Adams done, it looks like when storage_capacity = 0 that often that these laptops do have storage but its just like flash storage and I don't know if we should just get rid or them or not but thought I'd at least say x.
```

```{r renaming price to logprice  - Jamie}

laptop_data_tidy <-laptop_data_tidy %>%
  rename(,log_price_rupees = Price)

#only needs ran once as i overwrite the old file 


```

```{r calculating price in pounds  - Jamie}

laptop_data_tidy <-laptop_data_tidy %>%
  mutate(
        log_price = log(round(exp(log_price_rupees) * 0.0094 , digits =2)),
        Price = round(exp(log_price),digits = 2)
        
         )

#calculating log price in gbp and price in gbp,
  
laptop_data_tidy <-laptop_data_tidy%>%
  select(-log_price_rupees)

#getting rid of log price rupees cos we aint using it


#chunk only needs to be ran once as it overwrites the old file 

laptop_data_final <- laptop_data_tidy


```

<h3> Data Visualisation and exploring  </h3> 

=======
```{r exploratory data analysis}
laptop_data_final %>%
  summarise(across(everything(), ~sum(is.na(.))))
#there are no NA values

laptop_data %>%
  select(Ram, Weight, Price, Ppi, HDD, SSD) %>%
  summarise(
    across(
      .cols = everything(),  
      .fns = list(
        min = ~min(. , na.rm = TRUE),
        mean = ~mean(. , na.rm = TRUE),
        median = ~median(. , na.rm = TRUE),
        max = ~max(. , na.rm = TRUE)
      )
    )
  ) %>%
  pivot_longer(
    cols = everything(),
    names_to = c("Statistic", "Variable"),
    names_pattern = "(.*)_(.*)",
    values_to = "Value"
  ) %>%
  pivot_wider(names_from = Variable, values_from = Value)

# Calculating correlations
correlation_matrix <- laptop_data %>%
  select_if(is.numeric) %>%
  cor(use = "complete.obs")

correlation_matrix

#closer to 1 = greater the correlation

```
**Notes:**

- There are no NA values

- RAM and Price have a strong positive correlation, meaning that higher RAM is - associated with higher prices.

- Weight has a weak positive correlation with Price, indicating that heavier laptops may have slightly higher prices.

- TouchScreen, IPS, and PPI have positive correlations with Price, suggesting that better display features are associated with higher prices.

- SSD has a strong positive correlation with Price, indicating that larger SSD storage is linked to higher prices.

- HDD has a weak negative correlation with Price, implying that larger HDD storage may result in slightly lower prices.

```{r investigating laptop types}

#in this chunk I want to gain more insight on the characteristics of the different laptop types to indicate if the existence of certain variables increase the likelihood of what laptop type the device is

laptop_data %>%
  count(TypeName)

#Calculating the average values for each laptop type
avg_stats <- laptop_data %>%
  group_by(TypeName) %>%
  summarise(
    Avg_Ram = mean(Ram, na.rm = TRUE),
    Avg_Weight = mean(Weight, na.rm = TRUE),
    Avg_Price = mean(Price, na.rm = TRUE),
    Avg_Ppi = mean(Ppi, na.rm = TRUE),
    Avg_HDD = mean(HDD, na.rm = TRUE),
    Avg_SSD = mean(SSD, na.rm = TRUE)
  )
print(avg_stats)

avg_stats_long <- avg_stats %>%
  pivot_longer(cols = starts_with("Avg_"), names_to = "Variable", values_to = "Value")

#Creating a bunch of bar charts
ggplot(avg_stats_long, aes(x = TypeName, y = Value, fill = TypeName)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  facet_wrap(~Variable, scales = "free_y") +
  labs(
    title = "Average Specifications by Laptop Type",
    x = "Laptop Type",
    y = "Average Value",
    fill = "Variable"
  ) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))


#on to box plots now
variables <- c("Ram", "Weight", "Price", "Ppi", "HDD", "SSD")

avg_stats_long <- laptop_data %>%
  select(TypeName, Ram, Weight, Price, Ppi, HDD, SSD) %>% 
  pivot_longer(
    cols = Ram:SSD,          
    names_to = "Variable",   
    values_to = "Value"      
  )

# visualising the box plots
ggplot(avg_stats_long, aes(x = TypeName, y = Value, fill = Variable)) +
  geom_boxplot() +
  facet_wrap(~Variable, scales = "free_y") +
  theme_minimal() +
  labs(
    title = "Specifications by Laptop Type",
    x = "Laptop Type",
    y = "Value",
    fill = "Specification"
  ) +
  theme(axis.text.x = element_text(angle = 90)) 

```
<h3>Discoveries:</h3>

**2-in-1 Convertible**

•	<u>Specifications:</u> Moderate specifications across all categories.

•	<u>HDD & SSD: </u> Limited HDD capacity, but average SSD storage.

•	<u>Weight:</u> Lightweight, making it portable.

•	<u>Price:</u> Mid-range pricing compared to other categories.

•	<u>Usage: </u> Suitable for users prioritizing portability and versatility without requiring high-end performance.

**Gaming**

•	<u>Specifications:</u> High RAM and large HDD capacity.

•	<u>Price:</u> On the higher end.

•	<u>Weight: </u> Among the heaviest laptops due to extensive components.

•	<u>Usage: </u>Ideal for gamers or users needing high processing power for tasks eg 3D modeling or video editing.

**Netbook**

•	<u>Specifications: </u> Minimal specifications, including very small SSDs, RAM, and display resolution (PPI).

•	<u>Price: </u> Budget-friendly, making it the cheapest among categories.

•	<u>Weight: </u> Very lightweight and portable.

•	<u>Usage: </u> Suitable for basic tasks such as web browsing and document editing.

**Notebook**

•	<u>Specifications:</u> Balanced features, with moderate HDD, SSD, and RAM capacity.

•	<u>Price:</u> Mid-range, providing value for general-purpose users.

•	<u>Weight:</u> Medium weight.

•	<u>Usage:</u> Designed for students and professionals seeking an all-purpose laptop.

**Ultrabook**

•	<u>Specifications: </u>Higher SSD storage, average PPI, and lightweight build.

•	<u>Price: </u>Premium-priced due to sleek design and portability.

•	<u>Weight: </u>One of the lightest laptop types.

•	<u>Usage: </u>Best for business professionals who value portability and premium build quality.

**Workstation**

•	<u>Specifications:</u> High performance, featuring maximum SSD storage and high RAM.

•	<u>Price:</u> The most expensive category due to professional-grade hardware.

•	<u>Weight:</u> Heavy, reflecting the high-end components.

•	<u>Usage:</u> Suitable for heavy workloads, such as software development, simulations, and engineering tasks.


```{r test-scatter-plot}
laptop_data %>%
  ggplot(mapping = aes(x=Weight,y=Price, color=factor(TypeName))) +
  geom_point() +
  geom_smooth(aes(group = 1), method = "lm")

```
this looks promising for looking at models/best fits
==================

<h3> Modelling </h3> 

```{r best-fit}
price_fit <- linear_reg() %>%
  set_engine("lm") %>%
  fit(Price ~ Weight + SSD, data=laptop_data) # add the other numeric values
tidy(price_fit)
```

So P = 10.1 + 0.175W+0.00222S




