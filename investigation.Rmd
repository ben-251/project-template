---
title: "IDS investigation worksheet - PULL BEFORE EDITING GUYS!!!"
author: "by The Code Crunchers: Gigi, Ben, Jamie & Adam"
date: "`r Sys.Date()`"
output: html_document
---

**Note:** You can use this file as you 'working document' where you can try out various investigation ideas and keep notes about your findings. How you use and structure this file is up to you. It is recommended that you keep notes about what you are investigating and what you find as this will make the process of creating your presentation and report easier. Please note that you _do not_ need to submit this file as part of your group project.



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r load-lib, message = FALSE}
library(tidyverse)
library(tidymodels)
```


```{r load-data}
laptop_data <- read_csv("data/laptop_data_cleaned.csv")
```


```{r creating storage_type column - Jamie}
laptop_data <- laptop_data%>% 
  mutate(, 
storage_type = case_when(
    HDD == 0 ~ "ssd",
    SSD == 0 ~ "hss",
    .default = "both"
  ))

```

=======
```{r exploratory data analysis}
laptop_data %>%
  summarise(across(everything(), ~sum(is.na(.))))
#there are no NA values

laptop_data %>%
  select(Ram, Weight, Price, Ppi, HDD, SSD) %>%
  summarise(
    across(
      .cols = everything(),  # Apply to all columns
      .fns = list(
        min = ~min(. , na.rm = TRUE),
        mean = ~mean(. , na.rm = TRUE),
        median = ~median(. , na.rm = TRUE),
        max = ~max(. , na.rm = TRUE)
      )
    )
  ) %>%
  pivot_longer(
    cols = everything(),
    names_to = c("Statistic", "Variable"),
    names_pattern = "(.*)_(.*)",
    values_to = "Value"
  ) %>%
  pivot_wider(names_from = Variable, values_from = Value)

correlation_matrix <- laptop_data %>%
  select_if(is.numeric) %>%
  cor(use = "complete.obs")

correlation_matrix

#closer to 1 = greater the correlation

```
**Notes:**

- There are no NA values

- RAM and Price have a strong positive correlation, meaning that higher RAM is - associated with higher prices.

- Weight has a weak positive correlation with Price, indicating that heavier laptops may have slightly higher prices.

- TouchScreen, IPS, and PPI have positive correlations with Price, suggesting that better display features are associated with higher prices.

- SSD has a strong positive correlation with Price, indicating that larger SSD storage is linked to higher prices.

- HDD has a weak negative correlation with Price, implying that larger HDD storage may result in slightly lower prices.


```{r test-scatter-plot}
laptop_data %>%
  ggplot(mapping = aes(x=Weight,y=Price, color=factor(TypeName))) +
  geom_point() +
  geom_smooth(aes(group = 1), method = "lm")

```
this looks promising for looking at models/best fits
```{r best-fit}
price_fit <- linear_reg() %>%
  set_engine("lm") %>%
  fit(Price ~ Weight + SSD, data=laptop_data) # add the other numeric values
tidy(price_fit)
```

So P = 10.1 + 0.175W+0.00222S


```{r adam}
laptop_data_untidy <- read.csv("data/laptop_data.csv")
laptop_data_untidy <- laptop_data_untidy%>%
  mutate(Ram = parse_number(Ram))
laptop_data_untidy <- laptop_data_untidy%>%
  mutate(Weight = parse_number(Weight))
laptop_data_untidy <- laptop_data_untidy%>%
  mutate(Second_Price = Price)
laptop_data_filtered <- laptop_data_untidy [-1192, ]
laptop_data_filtered <- laptop_data_filtered[1:1273, ]

#check
first_diff <- which(!(laptop_data$Company == laptop_data_filtered$Company & laptop_data$TypeName == laptop_data_filtered$TypeName & laptop_data$Ram == laptop_data_filtered$Ram ))
second_diff <- all(abs(laptop_data$Weight - laptop_data_filtered$Weight) < .Machine$double.eps^0.5)

##view(select(laptop_data_filtered, Ram, Weight, Company, TypeName))
##view(select(laptop_data, Ram, Weight, Company, TypeName))
##print(first_diff)
##print(second_diff)

laptop_data_merged <- cbind(laptop_data, select(laptop_data_filtered, Second_Price, Inches, ScreenResolution, Cpu, Gpu, Memory)) 

```


```{r creating storage_capacity column - Jamie}




```